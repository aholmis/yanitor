@page "/my-house"
@page "/{culture}/my-house"
@using System.Globalization
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<MyHouse> L

<PageTitle>@L["PageTitle"]</PageTitle>

<section class="my-house">
    <header class="my-house__header">
        <h1 class="my-house__title">@L["PageTitle"]</h1>
        <p class="my-house__subtitle">@L["Subtitle"]</p>
    </header>

    <div class="my-house__cards">
        <article class="my-house__card my-house__card--tasks">
            <div class="my-house__card-icon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <path d="M9 11l3 3L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
            </div>
            <div class="my-house__card-content">
                <h2 class="my-house__card-title">@L["TasksTitle"]</h2>
                <p class="my-house__card-count">@_tasksCount</p>
                @if (_nextTask != null)
                {
                    <div class="my-house__next-task">
                        <p class="my-house__next-task-label">@L["NextTask"]:</p>
                        <p class="my-house__next-task-name">@_nextTask.Name</p>
                        <p class="my-house__next-task-due">@GetDaysUntilDueText(_nextTask.DaysUntilDue)</p>
                    </div>
                }
                else
                {
                    <p class="my-house__card-description">@L["NoTasksDescription"]</p>
                }
            </div>
        </article>

        <article class="my-house__card my-house__card--components">
            <div class="my-house__card-icon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M9 22V12h6v10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="my-house__card-content">
                <h2 class="my-house__card-title">@L["ComponentsTitle"]</h2>
                <p class="my-house__card-count">@_componentsCount</p>
                <p class="my-house__card-description">@L["ComponentsDescription"]</p>
            </div>
        </article>

    </div>
</section>

@code {
    [Parameter]
    public string? Culture { get; set; }

    // Mock data - replace with actual data service later
    private int _componentsCount = 12;
    private int _tasksCount = 5;
    private NextTask? _nextTask = new NextTask { Name = "Clean gutters", DaysUntilDue = 3 };

    private string GetDaysUntilDueText(int days)
    {
        if (days == 0)
            return L["DueToday"];
        if (days == 1)
            return L["DueTomorrow"];
        if (days < 0)
            return L["Overdue", Math.Abs(days)];
        
        return L["DueInDays", days];
    }

    private record NextTask
    {
        public required string Name { get; init; }
        public int DaysUntilDue { get; init; }
    }
}
